From e22081347f0878d93ef0f7ddc21df8ef15ebdec3 Mon Sep 17 00:00:00 2001
From: Tad <tad@spotco.us>
Date: Thu, 3 May 2018 07:28:57 -0400
Subject: [PATCH] Change fallback, tethering, and test DNS servers to
 Cloudflare

Change-Id: I698295711c3409f01394dce7268461518dfa0064
---
 core/res/res/values/config.xml                                | 2 +-
 packages/SettingsLib/res/values/strings.xml                   | 4 ++--
 .../com/android/server/connectivity/NetworkDiagnostics.java   | 4 ++--
 .../server/connectivity/tethering/TetheringConfiguration.java | 2 +-
 4 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/core/res/res/values/config.xml b/core/res/res/values/config.xml
index 3ce8959a983..3b1ae251fad 100644
--- a/core/res/res/values/config.xml
+++ b/core/res/res/values/config.xml
@@ -1651,7 +1651,7 @@
     <bool name="config_bluetooth_default_profiles">true</bool>
 
     <!-- IP address of the dns server to use if nobody else suggests one -->
-    <string name="config_default_dns_server" translatable="false">8.8.8.8</string>
+    <string name="config_default_dns_server" translatable="false">1.0.0.1</string>
 
     <!-- The default mobile provisioning apn. Empty by default, maybe overridden by
          an mcc/mnc specific config.xml -->
diff --git a/packages/SettingsLib/res/values/strings.xml b/packages/SettingsLib/res/values/strings.xml
index bd884a3c972..c8fe7e54d9b 100644
--- a/packages/SettingsLib/res/values/strings.xml
+++ b/packages/SettingsLib/res/values/strings.xml
@@ -921,9 +921,9 @@
     <!-- Hint text for the IP address -->
     <string name="wifi_ip_address_hint" translatable="false">192.168.1.128</string>
     <!-- Hint text for DNS -->
-    <string name="wifi_dns1_hint" translatable="false">8.8.8.8</string>
+    <string name="wifi_dns1_hint" translatable="false">1.0.0.1</string>
     <!-- Hint text for DNS -->
-    <string name="wifi_dns2_hint" translatable="false">8.8.4.4</string>
+    <string name="wifi_dns2_hint" translatable="false">1.1.1.1</string>
     <!-- Hint text for the gateway -->
     <string name="wifi_gateway_hint" translatable="false">192.168.1.1</string>
     <!-- Hint text for network prefix length -->
diff --git a/services/core/java/com/android/server/connectivity/NetworkDiagnostics.java b/services/core/java/com/android/server/connectivity/NetworkDiagnostics.java
index 85d1d1ef1d7..6681109ea4a 100644
--- a/services/core/java/com/android/server/connectivity/NetworkDiagnostics.java
+++ b/services/core/java/com/android/server/connectivity/NetworkDiagnostics.java
@@ -85,9 +85,9 @@ import libcore.io.IoUtils;
 public class NetworkDiagnostics {
     private static final String TAG = "NetworkDiagnostics";
 
-    private static final InetAddress TEST_DNS4 = NetworkUtils.numericToInetAddress("8.8.8.8");
+    private static final InetAddress TEST_DNS4 = NetworkUtils.numericToInetAddress("1.0.0.1");
     private static final InetAddress TEST_DNS6 = NetworkUtils.numericToInetAddress(
-            "2001:4860:4860::8888");
+            "2606:4700:4700::1111");
 
     // For brevity elsewhere.
     private static final long now() {
diff --git a/services/core/java/com/android/server/connectivity/tethering/TetheringConfiguration.java b/services/core/java/com/android/server/connectivity/tethering/TetheringConfiguration.java
index acbc10b9dc4..6dd661bfdb8 100644
--- a/services/core/java/com/android/server/connectivity/tethering/TetheringConfiguration.java
+++ b/services/core/java/com/android/server/connectivity/tethering/TetheringConfiguration.java
@@ -65,7 +65,7 @@ public class TetheringConfiguration {
         "192.168.48.2", "192.168.48.254", "192.168.49.2", "192.168.49.254",
     };
 
-    private final String[] DEFAULT_IPV4_DNS = {"8.8.4.4", "8.8.8.8"};
+    private final String[] DEFAULT_IPV4_DNS = {"1.0.0.1", "1.1.1.1"};
 
     public final String[] tetherableUsbRegexs;
     public final String[] tetherableWifiRegexs;
-- 
2.17.0

