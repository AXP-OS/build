From 3c31c1f1188e1c550f02d838daa8e7c2e55e6f56 Mon Sep 17 00:00:00 2001
From: Tad <tad@spotco.us>
Date: Mon, 23 Apr 2018 02:39:35 -0400
Subject: [PATCH] deny all new usb devices until after boot

Change-Id: I7a3dad49610eb4010dc13a3acaffb6fd91cdc89c
---
 rootdir/init.rc | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/rootdir/init.rc b/rootdir/init.rc
index c1bd58eba..38f3bab9f 100644
--- a/rootdir/init.rc
+++ b/rootdir/init.rc
@@ -18,6 +18,9 @@ on early-init
     # Disable sysrq from keyboard
     write /proc/sys/kernel/sysrq 0
 
+    # Deny all new USB devices until after boot
+    write /proc/sys/kernel/deny_new_usb 1
+
     # Set the security context of /adb_keys if present.
     restorecon /adb_keys
 
-- 
2.17.0

