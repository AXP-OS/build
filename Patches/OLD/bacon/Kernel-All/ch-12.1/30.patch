From 1199ff4cab87fe53ebdfbf9d886d879de683bfac Mon Sep 17 00:00:00 2001
From: Tad <tad@spotco.us>
Date: Thu, 19 Nov 2015 07:55:42 -0500
Subject: [PATCH] Build fixes

---
 include/net/inetpeer.h       | 2 +-
 kernel/power/wakeup_reason.c | 2 +-
 2 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/include/net/inetpeer.h b/include/net/inetpeer.h
index e617e3e..1569625 100644
--- a/include/net/inetpeer.h
+++ b/include/net/inetpeer.h
@@ -116,7 +116,7 @@ static inline int inet_getid(struct inet_peer *p, int more)
 {
 	more++;
 	inet_peer_refcheck(p);
-	return atomic_add_return(more, &p->ip_id_count) - more;
+	return atomic_add_return_unchecked(more, &p->ip_id_count) - more;
 }
 
 #endif /* _NET_INETPEER_H */
diff --git a/kernel/power/wakeup_reason.c b/kernel/power/wakeup_reason.c
index fab0889..a086ccc 100644
--- a/kernel/power/wakeup_reason.c
+++ b/kernel/power/wakeup_reason.c
@@ -309,7 +309,7 @@ static struct attribute_group attr_group = {
 
 static inline void stop_logging_wakeup_reasons(void)
 {
-	ACCESS_ONCE(log_wakeups) = false;
+	ACCESS_ONCE_RW(log_wakeups) = false;
 	smp_wmb();
 }
 
