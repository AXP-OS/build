From dee29e1d481bb201f249fbc97855767698f77be3 Mon Sep 17 00:00:00 2001
From: Tad <tad@spotco.us>
Date: Sun, 22 Oct 2017 23:21:58 -0400
Subject: [PATCH] Fix Keystore

See the following
https://github.com/LineageOS/android_frameworks_base/commit/4812563f68c87278af68309662433279d10f573e
https://github.com/CopperheadOS/platform_frameworks_base/commit/67a220a896ff4b28706eda855ebb2d52f8dcbfd0
https://github.com/flocke/andOTP/issues/16
https://jira.lineageos.org/browse/BUGBASH-590

Change-Id: I733d7d6620ff50930dd7b5a579607d78fa5a12b0
---
 core/java/android/app/ActivityThread.java | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/core/java/android/app/ActivityThread.java b/core/java/android/app/ActivityThread.java
index eb257c59b5c..e6a66a56b00 100644
--- a/core/java/android/app/ActivityThread.java
+++ b/core/java/android/app/ActivityThread.java
@@ -82,6 +82,7 @@ import android.os.Trace;
 import android.os.TransactionTooLargeException;
 import android.os.UserHandle;
 import android.provider.Settings;
+import android.security.keystore.AndroidKeyStoreProvider;
 import android.security.NetworkSecurityPolicy;
 import android.security.net.config.NetworkSecurityConfigProvider;
 import android.util.AndroidRuntimeException;
@@ -6161,6 +6162,8 @@ public final class ActivityThread {
         // Set the reporter for event logging in libcore
         EventLogger.setReporter(new EventLoggingReporter());
 
+        AndroidKeyStoreProvider.install();
+
         // Make sure TrustedCertificateStore looks in the right place for CA certificates
         final File configDir = Environment.getUserConfigDirectory(UserHandle.myUserId());
         TrustedCertificateStore.setDefaultUserDirectory(configDir);
-- 
2.14.2

