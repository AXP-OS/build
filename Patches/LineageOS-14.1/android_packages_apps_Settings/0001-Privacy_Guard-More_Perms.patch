From bc77347e083fec0197da88fd940d23896f2706aa Mon Sep 17 00:00:00 2001
From: Tad <tad@spotco.us>
Date: Fri, 8 Dec 2017 03:07:24 -0500
Subject: [PATCH] PrivacyGuard: Allow control over more permissions

Change-Id: I46fae35ec2cf6fb560de89581d935cd023b25a86
---
 .../android/settings/applications/AppOpsState.java | 60 +++++++++++++++-------
 1 file changed, 42 insertions(+), 18 deletions(-)

diff --git a/src/com/android/settings/applications/AppOpsState.java b/src/com/android/settings/applications/AppOpsState.java
index 6935d06931..0bcd690bcf 100644
--- a/src/com/android/settings/applications/AppOpsState.java
+++ b/src/com/android/settings/applications/AppOpsState.java
@@ -113,11 +113,11 @@ public class AppOpsState {
                     AppOpsManager.OP_MONITOR_HIGH_POWER_LOCATION },
             new boolean[] { true,
                     true,
-                    false,
-                    false,
-                    false,
-                    false,
-                    false }
+                    true,
+                    true,
+                    true,
+                    true,
+                    true }
             );
 
     public static final OpsTemplate PERSONAL_TEMPLATE = new OpsTemplate(
@@ -128,15 +128,27 @@ public class AppOpsState {
                     AppOpsManager.OP_READ_CALENDAR,
                     AppOpsManager.OP_WRITE_CALENDAR,
                     AppOpsManager.OP_READ_CLIPBOARD,
-                    AppOpsManager.OP_WRITE_CLIPBOARD },
+                    AppOpsManager.OP_WRITE_CLIPBOARD,
+                    AppOpsManager.OP_GET_USAGE_STATS,
+                    AppOpsManager.OP_BODY_SENSORS,
+                    AppOpsManager.OP_GET_ACCOUNTS,
+                    AppOpsManager.OP_USE_FINGERPRINT,
+                    AppOpsManager.OP_ADD_VOICEMAIL,
+                    AppOpsManager.OP_WRITE_WALLPAPER },
             new boolean[] { true,
                     true,
                     true,
                     true,
                     true,
                     true,
-                    false,
-                    false }
+                    true,
+                    true,
+                    true,
+                    true,
+                    true,
+                    true,
+                    true,
+                    true }
             );
 
     public static final OpsTemplate MESSAGING_TEMPLATE = new OpsTemplate(
@@ -148,8 +160,10 @@ public class AppOpsState {
                     AppOpsManager.OP_WRITE_SMS,
                     AppOpsManager.OP_SEND_SMS,
                     AppOpsManager.OP_READ_ICC_SMS,
-                    AppOpsManager.OP_WRITE_ICC_SMS },
+                    AppOpsManager.OP_WRITE_ICC_SMS,
+                    AppOpsManager.OP_READ_CELL_BROADCASTS },
             new boolean[] { true,
+                    true,
                     true,
                     true,
                     true,
@@ -175,7 +189,10 @@ public class AppOpsState {
                     AppOpsManager.OP_AUDIO_NOTIFICATION_VOLUME,
                     AppOpsManager.OP_AUDIO_BLUETOOTH_VOLUME,
                     AppOpsManager.OP_MUTE_MICROPHONE },
-            new boolean[] { false,
+            new boolean[] { true,
+                    true,
+                    true,
+                    true,
                     true,
                     true,
                     false,
@@ -185,10 +202,7 @@ public class AppOpsState {
                     false,
                     false,
                     false,
-                    false,
-                    false,
-                    false,
-                    false }
+                    true }
             );
 
     public static final OpsTemplate DEVICE_TEMPLATE = new OpsTemplate(
@@ -205,8 +219,15 @@ public class AppOpsState {
                     AppOpsManager.OP_CHANGE_WIFI_STATE,
                     AppOpsManager.OP_BLUETOOTH_CHANGE,
                     AppOpsManager.OP_NFC_CHANGE,
-                    AppOpsManager.OP_DATA_CONNECT_CHANGE },
+                    AppOpsManager.OP_DATA_CONNECT_CHANGE,
+                    AppOpsManager.OP_PROCESS_OUTGOING_CALLS,
+                    AppOpsManager.OP_USE_SIP,
+                    AppOpsManager.OP_READ_PHONE_STATE,
+                    AppOpsManager.OP_READ_EXTERNAL_STORAGE,
+                    AppOpsManager.OP_WRITE_EXTERNAL_STORAGE },
             new boolean[] { false,
+                    true,
+                    true,
                     true,
                     true,
                     true,
@@ -214,8 +235,11 @@ public class AppOpsState {
                     true,
                     false,
                     false,
-                    false,
-                    false,
+                    true,
+                    true,
+                    true,
+                    true,
+                    true,
                     true,
                     true,
                     true,
@@ -224,7 +248,7 @@ public class AppOpsState {
 
     public static final OpsTemplate RUN_IN_BACKGROUND_TEMPLATE = new OpsTemplate(
             new int[] { AppOpsManager.OP_RUN_IN_BACKGROUND },
-            new boolean[] { false }
+            new boolean[] { true }
             );
 
     public static final OpsTemplate BOOTUP_TEMPLATE = new OpsTemplate(
-- 
2.15.1

