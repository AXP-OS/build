From c4f32c685eb310b57285e26136c999be9cd2b770 Mon Sep 17 00:00:00 2001
From: Tad <tad@spotco.us>
Date: Sun, 18 Jun 2017 10:20:13 -0400
Subject: [PATCH] Switch to our update server

Change-Id: I53fc23e0e51ae03e449cd174591e1d3533bbdd74
---
 .../updater/requests/UpdatesJsonObjectRequest.java            |  3 ++-
 src/com/cyanogenmod/updater/service/UpdateCheckService.java   | 11 +----------
 2 files changed, 3 insertions(+), 11 deletions(-)

diff --git a/src/com/cyanogenmod/updater/requests/UpdatesJsonObjectRequest.java b/src/com/cyanogenmod/updater/requests/UpdatesJsonObjectRequest.java
index 13d22b7..af9980b 100644
--- a/src/com/cyanogenmod/updater/requests/UpdatesJsonObjectRequest.java
+++ b/src/com/cyanogenmod/updater/requests/UpdatesJsonObjectRequest.java
@@ -11,6 +11,7 @@ package com.cyanogenmod.updater.requests;
 
 import com.android.volley.AuthFailureError;
 import com.android.volley.Response;
+import com.android.volley.Request;
 import com.android.volley.toolbox.JsonObjectRequest;
 import org.json.JSONObject;
 
@@ -23,7 +24,7 @@ public class UpdatesJsonObjectRequest extends JsonObjectRequest {
 
     public UpdatesJsonObjectRequest(String url, String userAgent, JSONObject jsonRequest,
             Response.Listener<JSONObject> listener, Response.ErrorListener errorListener) {
-        super(url, jsonRequest, listener, errorListener);
+        super(Request.Method.GET, url, jsonRequest, listener, errorListener);
         mUserAgent = userAgent;
     }
 
diff --git a/src/com/cyanogenmod/updater/service/UpdateCheckService.java b/src/com/cyanogenmod/updater/service/UpdateCheckService.java
index 9fc81d6..f76910a 100644
--- a/src/com/cyanogenmod/updater/service/UpdateCheckService.java
+++ b/src/com/cyanogenmod/updater/service/UpdateCheckService.java
@@ -200,16 +200,7 @@ public class UpdateCheckService extends IntentService
     }
 
     private URI getServerURI() {
-        String updateUri = SystemProperties.get("cm.updater.uri");
-        if (TextUtils.isEmpty(updateUri)) {
-            updateUri = getString(R.string.conf_update_server_url_def);
-        }
-
-        String incrementalVersion = SystemProperties.get("ro.build.version.incremental");
-        updateUri += "/v1/" + Utils.getDeviceType() + "/" +
-                Utils.getInstalledBuildType() + "/" + incrementalVersion;
-
-        return URI.create(updateUri);
+        return URI.create("https://divestos.xyz/updater.php?device=" + Utils.getDeviceType());
     }
 
     private void getAvailableUpdates() {
-- 
2.13.1

